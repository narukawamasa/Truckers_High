<div class="search_form">
  <%= form_with url: companies_path, local: true, method: :get do |f| %>
    <%= f.text_field :word, placeholder:"会社名を記入" %>
    <%= f.select :search, options_for_select([["完全一致","perfect_match"], ["前方一致","forward_match"],  ["後方一致","backward_match"], ["部分一致","partial_match"]]) %>
    <%= f.submit "検索", class: "btn btn-primary" %>
  <% end %>
</div>
<div class="container">
  <% if @word_error.present? %>
    <h3>”<%= @word_error %>”で一致する会社はありません。</h3>
  <% elsif @word.present? %>
    <h3>”<%= @word %>”での検索結果</h3>
  <% end %>
  <div class="row">
    <%= link_to "新規登録", new_company_path %>
  </div>
  <table class="table">
    <thead>
      <tr>
        <th scope="col">会社名</th>
        <th scope="col">郵便番号</th>
        <th scope="col">住所</th>
        <th scope="col">電話番号</th>
        <th scope="col"></th>
      </tr>
    </thead>
    <tbody>
      <% @companies.each do |company| %>
      <tr>
        <td>
          <%= link_to company_path(company.id) do %>
            <%= company.name %>
          <% end %>
        </td>
        <td>〒<%= company.postal_code %></td>
        <td><%= company.address %></td>
        <td><%= company.phone_number %></td>
        <td>
          <% if company.bookmarks.exists?(driver_id: current_driver.id) %>
          <% bookmark = Bookmark.find_by(driver_id: current_driver.id, company_id: company.id) %>
            <%= link_to "ブックマークから外す", bookmark_path(bookmark), method: :delete %>
          <% else %>
            <%= form_with model: @bookmark, url: bookmarks_path, method: :post do |f| %>
              <%= f.hidden_field :driver_id, :value => current_driver.id %>
              <%= f.hidden_field :company_id, :value => company.id %>
              <%= f.submit "ブックマークする" %>
            <% end %>
          <% end %>
        </td>
      </tr>
      <% end %>
    </tbody>
  </table>
</div>